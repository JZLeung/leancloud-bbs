{"version":3,"sources":["webpack:///./src/plugins/consts.js","webpack:///./src/views/topic/new.vue?fc7a","webpack:///./src/views/topic/new.vue?533c","webpack:///src/views/topic/new.vue","webpack:///./src/views/topic/new.vue?3ff8","webpack:///./src/views/topic/new.vue"],"names":["INPUT_TYPES","ERROR","SUCCESS","NORMAL","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_new_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","label","type","types","title","message","errors","model","value","form","callback","$$v","$set","expression","content","maxlength","href","on","click","submit","staticRenderFns","newvue_type_script_lang_js_","data","id","methods","check","_this$form","length","_this","consts","Object","topic","then","console","log","$router","replace","name","params","catch","err","error","mounted","_mounted","asyncToGenerator","regeneratorRuntime","mark","_callee","tid","detail","current","wrap","_context","prev","next","$route","sent","user","uid","$toast","open","stop","apply","arguments","topic_newvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"js/topicNew.901267cf.js","sourcesContent":["export const INPUT_TYPES = {\n    ERROR: 'is-danger',\n    SUCCESS: 'is-success',\n    NORMAL: ''\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./new.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./new.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"new-topic-page\"},[_c('section',[_c('h3',{staticClass:\"is-3\"},[_vm._v(\"发表新话题\")]),_c('b-field',{attrs:{\"label\":\"标题\",\"type\":_vm.types.title,\"message\":_vm.errors.title}},[_c('b-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('b-field',{attrs:{\"label\":\"内容\",\"type\":_vm.types.content,\"message\":_vm.errors.content}},[_c('b-input',{attrs:{\"maxlength\":\"2048\",\"type\":\"textarea\"},model:{value:(_vm.form.content),callback:function ($$v) {_vm.$set(_vm.form, \"content\", $$v)},expression:\"form.content\"}})],1),_c('b-field',[_c('a',{staticClass:\"control\",attrs:{\"href\":\"https://guides.github.com/features/mastering-markdown/\"}},[_c('small',[_vm._v(\"Styling with Markdown is supported\")])])]),_c('b-field',[_c('a',{staticClass:\"button is-primary\",on:{\"click\":_vm.submit}},[_vm._v(\"提交\")])])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n.new-topic-page\n    section\n        h3.is-3 发表新话题\n        b-field(label='标题', :type='types.title', :message='errors.title')\n            b-input(v-model='form.title')\n        b-field(label='内容', :type='types.content', :message='errors.content')\n            b-input(v-model='form.content', maxlength=\"2048\", type=\"textarea\")\n        b-field\n            a.control(href='https://guides.github.com/features/mastering-markdown/') \n                small Styling with Markdown is supported\n        b-field\n            a.button.is-primary(@click='submit') 提交\n</template>\n\n<script>\nimport {postNew, getDetail} from '@/api/topic'\nimport {isLogin} from '@/api/user'\nimport {INPUT_TYPES} from '@/plugins/consts'\nexport default {\n    data: () => ({\n        id: '',\n        form: {\n            title: '',\n            content: ''\n        },\n        types: {\n            title: '',\n            content: ''\n        },\n        errors: {\n            title: '',\n            content: ''\n        }\n    }),\n    methods: {\n        check() {\n            const {title, content} = this.form\n            const errors = {\n                title: true,\n                content: true\n            }\n            if (!title) {\n                errors.title = '请输入标题'\n            } else {\n                if (title.length < 5 || title.length > 20) {\n                    errors.title = '标题长度需要在 5-20 个字符内'\n                }\n            }\n\n            if (!content) {\n                errors.content = '请输入话题内容'\n            } else {\n                if (content.length < 20 || content.length > 2048) {\n                    errors.content = '标题长度需要在 20-2048 个字符内'\n                }\n            }\n            return errors\n        },\n        submit() {\n            const errors = this.check()\n            if (errors.title !== true || errors.content !== true) {\n                this.types.title = errors.title === true ? INPUT_TYPES.SUCCESS : INPUT_TYPES.ERROR\n                this.types.content = errors.content === true ? INPUT_TYPES.SUCCESS : INPUT_TYPES.ERROR\n\n                this.errors.title = errors.title === true ? '' : errors.title\n                this.errors.content = errors.content === true ? '' : errors.content\n                return false\n            }\n\n            postNew(this.form, this.id).then(topic => {\n                console.log(topic)\n                const id = topic.id\n                this.$router.replace({\n                    name: 'topicDetail',\n                    params: {\n                        id\n                    }\n                })\n            }).catch(err => {\n                console.error('postNew error:', err)\n            })\n        }\n    },\n    async mounted() {\n        if (this.$route.params.tid) {\n            const tid = this.$route.params.tid\n            const detail = await getDetail(tid, false)\n            const current = isLogin()\n            if (detail.uid !== current.id) {\n                this.$toast.open({\n                    message: '无权访问',\n                    type: 'is-danger'\n                })\n                this.$router.replace({\n                    name: 'topicDetail',\n                    params: {\n                        id: tid\n                    }\n                })\n            } else {\n                this.form.content = detail.content\n                this.form.title = detail.title\n                this.id = tid\n            }\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./new.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./new.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./new.vue?vue&type=template&id=f391ca42&lang=pug&\"\nimport script from \"./new.vue?vue&type=script&lang=js&\"\nexport * from \"./new.vue?vue&type=script&lang=js&\"\nimport style0 from \"./new.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"new.vue\"\nexport default component.exports"],"sourceRoot":""}