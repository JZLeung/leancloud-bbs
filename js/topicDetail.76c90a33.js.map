{"version":3,"sources":["webpack:///./src/views/topic/detail.vue?e3ae","webpack:///src/views/topic/detail.vue","webpack:///./src/views/topic/detail.vue?326d","webpack:///./src/views/topic/detail.vue","webpack:///./src/plugins/consts.js","webpack:///./node_modules/core-js/modules/web.dom.iterable.js","webpack:///./src/service/reply.js","webpack:///./src/api/reply.js","webpack:///./src/views/topic/detail.vue?f04a"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","detail","title","attrs","to","name","params","uid","username","created_at","domProps","innerHTML","content","tid","id","_e","replys","length","_l","reply","key","src","avatar","_m","label","error","form","type","maxlength","model","value","callback","$$v","$set","expression","on","click","submit","staticStyle","margin-top","staticRenderFns","href","detailvue_type_script_lang_js_","data","computed","isLogin","$store","getters","methods","getDetail","_getDetail2","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","topic","sent","console","log","$data","stop","apply","arguments","getReplys","_getReplys2","_callee2","_context2","init","_init","_callee3","_context3","dispatch","check","consts","ERROR","NORMAL","_submit","_callee4","res","postRes","_context4","$toast","open","duration","message","position","mounted","$route","topic_detailvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","INPUT_TYPES","SUCCESS","$iterators","__webpack_require__","getKeys","redefine","global","hide","Iterators","wks","ITERATOR","TO_STRING_TAG","ArrayValues","Array","DOMIterables","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","collections","i","NAME","explicit","Collection","proto","prototype","Reply","leancloud","extend","getListByTopicId","_ref","topicId","query","Query","equalTo","addDescending","find","abrupt","_x","getListByUserId","_ref2","_x2","reply_postNew","user","User","current","Promise","reject","code","newReply","set","get","save","_users","users","catch","err","service_user","map","forEach","markdown","dayjs_min_default","createdAt","format","api_reply_postNew","errorHandler","_x3","getUserReplys","_ref3","_x4","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_detail_vue_vue_type_style_index_0_id_6e3dbf89_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/topicDetail.76c90a33.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"topic-detail-page\"},[_c('h2',{staticClass:\"is-2 title has-text-centered\"},[_vm._v(_vm._s(_vm.detail.title))]),_c('p',{staticClass:\"is-6 subtitle has-text-centered\"},[_c('router-link',{attrs:{\"to\":{name: \"userPage\", params: {uid: _vm.detail.uid}}}},[_vm._v(_vm._s(_vm.detail.username))]),_vm._v(\",\"),_c('span',[_vm._v(_vm._s(_vm.detail.created_at))])],1),_c('div',{staticClass:\"content\",domProps:{\"innerHTML\":_vm._s(_vm.detail.content)}}),_c('p',[(_vm.detail.self)?_c('router-link',{staticClass:\"button is-small is-warning\",attrs:{\"to\":{name: \"topicEdit\", params: {tid: _vm.detail.id}}}},[_vm._v(\"编辑\")]):_vm._e()],1),_c('div',{staticClass:\"divider\"}),_c('div',{staticClass:\"container\"},[_c('h4',{staticClass:\"title is-4\"},[_vm._v(\"共 \"+_vm._s(_vm.replys.length)+\" 条评论\")]),_c('section',{staticClass:\"replys-container\"},_vm._l((_vm.replys),function(reply){return _c('article',{key:reply.id,staticClass:\"media\"},[_c('div',{staticClass:\"media-left\"},[_c('figure',{staticClass:\"image is-64x64\"},[_c('img',{attrs:{\"src\":reply.avatar}})])]),_c('div',{staticClass:\"media-content\"},[_c('p',[_c('router-link',{staticClass:\"has-text-weight-bold\",attrs:{\"to\":{name: \"userPage\", params: {uid: reply.uid}}}},[_vm._v(_vm._s(reply.username))]),_c('small',{staticClass:\"tag is-warning is-dateline\"},[_vm._v(_vm._s(reply.created_at))])],1),_c('div',{staticClass:\"content\",domProps:{\"innerHTML\":_vm._s(reply.content)}})])])}))]),_c('div',{staticClass:\"divider\"}),_c('div',{staticClass:\"content\"},[(_vm.isLogin)?_c('form',{staticClass:\"reply-box\"},[_vm._m(0),_c('b-field',{attrs:{\"label\":\"添加回复\",\"error\":_vm.form.error,\"type\":_vm.form.type}},[_c('b-input',{attrs:{\"maxlength\":\"200\",\"type\":\"textarea\"},model:{value:(_vm.form.content),callback:function ($$v) {_vm.$set(_vm.form, \"content\", $$v)},expression:\"form.content\"}})],1),_c('b-field',[_c('a',{staticClass:\"button is-primary\",on:{\"click\":_vm.submit}},[_vm._v(\"提交\")])])],1):_c('div',{staticClass:\"has-text-centered\",staticStyle:{\"margin-top\":\"10px\"}},[_c('router-link',{staticClass:\"is-text is-primary\",attrs:{\"to\":{name: \"github\"}}},[_vm._v(\"登录发表评论\")])],1)])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a',{attrs:{\"href\":\"https://guides.github.com/features/mastering-markdown/\"}},[_c('small',[_vm._v(\"Styling with Markdown is supported\")])])}]\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n.topic-detail-page\n    h2.is-2.title.has-text-centered {{detail.title}}\n    p.is-6.subtitle.has-text-centered\n        router-link(:to='{name: \"userPage\", params: {uid: detail.uid}}') {{detail.username}}\n        | ,\n        span {{detail.created_at}}\n\n    .content(v-html='detail.content')\n    p\n        router-link.button.is-small.is-warning(v-if='detail.self', :to='{name: \"topicEdit\", params: {tid: detail.id}}') 编辑\n    .divider\n    .container\n        h4.title.is-4 共 {{replys.length}} 条评论\n        section.replys-container\n            article.media(v-for='reply in replys', :key='reply.id')\n                .media-left\n                    figure.image.is-64x64\n                        img(:src='reply.avatar')\n                .media-content\n                    \n                    p\n                        router-link.has-text-weight-bold(:to='{name: \"userPage\", params: {uid: reply.uid}}') {{reply.username}}\n                        small.tag.is-warning.is-dateline {{reply.created_at}}\n                    .content(v-html='reply.content')\n\n    .divider\n    .content\n        form.reply-box(v-if='isLogin')\n            a(href='https://guides.github.com/features/mastering-markdown/') \n                small Styling with Markdown is supported\n            b-field(label='添加回复', :error='form.error', :type='form.type')\n                b-input(v-model='form.content', maxlength=\"200\", type=\"textarea\")\n                \n            b-field\n                a.button.is-primary(@click='submit') 提交\n        .has-text-centered(v-else, style='margin-top:10px;')\n            router-link.is-text.is-primary(:to='{name: \"github\"}') 登录发表评论\n\n</template>\n\n<script>\nimport {getDetail} from '@/api/topic'\nimport {getReplys, postNew} from '@/api/reply'\nimport {INPUT_TYPES} from '@/plugins/consts'\nexport default {\n    data: () => ({\n        form: {\n            content: ''\n        },\n        detail: {},\n        replys: [],\n        id: ''\n    }),\n    computed: {\n        isLogin() {\n            return !!this.$store.getters.username\n        }\n    },\n    methods: {\n        async getDetail() {\n            const detail = await getDetail(this.id)\n            console.log(detail)\n            this.$set(this.$data, 'detail', detail)\n        },\n        async getReplys() {\n            const replys = await getReplys(this.id)\n            console.log(replys)\n            this.$set(this.$data, 'replys', replys)\n        },\n        async init() {\n            this.$store.dispatch('app/setLoading', true)\n            \n            await this.getDetail()\n            await this.getReplys()\n\n            this.$store.dispatch('app/setLoading', false)\n        },\n        check() {\n            if (!this.form.content) {\n                this.form.error = '请输入回复内容'\n                this.form.type = INPUT_TYPES.ERROR\n                return false\n            } else if (this.form.content.length < 5 || this.form.content.length > 200) {\n                this.form.error = '回复内容长度需在 5-200 个字符以内'\n                this.form.type = INPUT_TYPES.ERROR\n                return false\n            }\n            this.form.error = ''\n            this.form.type = INPUT_TYPES.NORMAL\n            return true\n        },\n        async submit() {\n            const res = this.check()\n            if (res) {\n                this.$store.dispatch('app/setLoading', true)\n                const postRes = await postNew(this.detail, this.form.content)\n                if (postRes) {\n                    this.form.content = ''\n                    this.$toast.open({\n                        duration: 1500,\n                        message: '回复成功',\n                        position: 'is-bottom',\n                        type: 'is-success'\n                    })\n                    await this.getReplys()\n                    this.$store.dispatch('app/setLoading', false)\n                } else {\n                    this.$toast.open({\n                        duration: 1500,\n                        message: '回复失败，请重试',\n                        position: 'is-bottom',\n                        type: 'is-danger'\n                    })\n                    this.$store.dispatch('app/setLoading', false)\n                }\n            }\n        }\n    },\n    mounted() {\n        this.id = this.$route.params.id\n        this.init()\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.media{\n    margin-bottom: 10px;\n    .is-dateline{\n        margin-left: 5px;\n    }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./detail.vue?vue&type=template&id=6e3dbf89&scoped=true&lang=pug&\"\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&id=6e3dbf89&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6e3dbf89\",\n  null\n  \n)\n\ncomponent.options.__file = \"detail.vue\"\nexport default component.exports","export const INPUT_TYPES = {\n    ERROR: 'is-danger',\n    SUCCESS: 'is-success',\n    NORMAL: ''\n}\n","var $iterators = require('./es6.array.iterator');\nvar getKeys = require('./_object-keys');\nvar redefine = require('./_redefine');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar wks = require('./_wks');\nvar ITERATOR = wks('iterator');\nvar TO_STRING_TAG = wks('toStringTag');\nvar ArrayValues = Iterators.Array;\n\nvar DOMIterables = {\n  CSSRuleList: true, // TODO: Not spec compliant, should be false.\n  CSSStyleDeclaration: false,\n  CSSValueList: false,\n  ClientRectList: false,\n  DOMRectList: false,\n  DOMStringList: false,\n  DOMTokenList: true,\n  DataTransferItemList: false,\n  FileList: false,\n  HTMLAllCollection: false,\n  HTMLCollection: false,\n  HTMLFormElement: false,\n  HTMLSelectElement: false,\n  MediaList: true, // TODO: Not spec compliant, should be false.\n  MimeTypeArray: false,\n  NamedNodeMap: false,\n  NodeList: true,\n  PaintRequestList: false,\n  Plugin: false,\n  PluginArray: false,\n  SVGLengthList: false,\n  SVGNumberList: false,\n  SVGPathSegList: false,\n  SVGPointList: false,\n  SVGStringList: false,\n  SVGTransformList: false,\n  SourceBufferList: false,\n  StyleSheetList: true, // TODO: Not spec compliant, should be false.\n  TextTrackCueList: false,\n  TextTrackList: false,\n  TouchList: false\n};\n\nfor (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {\n  var NAME = collections[i];\n  var explicit = DOMIterables[NAME];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  var key;\n  if (proto) {\n    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);\n    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n    Iterators[NAME] = ArrayValues;\n    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);\n  }\n}\n","import db from '@/plugins/leancloud'\n\n\nconst Reply = db.Object.extend('reply')\n\nexport const getListByTopicId = async topicId => {\n    const query = new db.Query('reply')\n    const replys = await query.equalTo('tid', topicId).addDescending('createdAt').find()\n    if (replys.length > 0) {\n        return replys\n    } else {\n        return []\n    }\n}\n\nexport const getListByUserId = async uid => {\n    const query = new db.Query('reply')\n    const replys = await query.equalTo('uid', uid).addDescending('createdAt').find()\n    if (replys.length > 0) {\n        return replys\n    } else {\n        return []\n    }\n}\n\nexport const postNew = (topic, content) => {\n    const user = db.User.current()\n    if (!user) return Promise.reject({code: 4112})\n    const newReply = new Reply()\n    newReply.set('content', content)\n    newReply.set('tid', topic.id)\n    newReply.set('uid', user.id)\n    newReply.set('username', user.get('username'))\n    newReply.set('title', topic.title)\n    return newReply.save()\n}\n","// import * as User from '@/service/user'\n// import * as Topic from '@/service/topic'\nimport * as Reply from '@/service/reply'\nimport * as User from '@/service/user'\nimport promise from './errorHandler'\n\nimport dayjs from 'dayjs'\nimport md from '@/plugins/markdown'\n\nexport const getReplys = async topicId => {\n    const replys = await Reply.getListByTopicId(topicId).catch(err => {\n        console.error(err)\n        return []\n    })\n    if (replys.length === 0) return []\n    const _users = await User.getUsersByUids(replys.map(reply => reply.get('uid')))\n    const users = {}\n    _users.forEach(user => {\n        users[user.id] = user\n    })\n    return replys.map(reply => {\n        const user = users[reply.get('uid')] || {\n            get() {}\n        }\n        return {\n            uid: reply.get('uid'),\n            content: md.render(reply.get('content')),\n            username: user.get('username'),\n            created_at: dayjs(reply.createdAt).format('YYYY-MM-DD HH:mm'),\n            avatar: user.get('avatar')\n        }\n    })\n}\n\nexport const postNew = async (topic, content) => {\n    return promise(Reply.postNew(topic, content))\n}\n\nexport const getUserReplys = async uid => {\n    const replys = await Reply.getListByUserId(uid)\n    if (replys.length === 0) return []\n    // const _topics = await Topic.getListByTopicIds(replys.map(reply => reply.get('tid')))\n    // const topics = {}\n    // _topics.list.forEach(topic => {\n    //     topics[topic.id] = topic\n    // })\n    return replys.map(reply => {\n        // const topic = topics[reply.get('tid')] || {\n        //     get() {}\n        // }\n        return {\n            tid: reply.get('tid'),\n            uid: reply.get('uid'),\n            content: md.render(reply.get('content')),\n            title: reply.get('title'),\n            created_at: dayjs(reply.createdAt).format('YYYY-MM-DD HH:mm')\n        }\n    })\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=style&index=0&id=6e3dbf89&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=style&index=0&id=6e3dbf89&lang=scss&scoped=true&\""],"sourceRoot":""}